{% extends "animals/base.html" %}
{% block title %}{{ animal.name }}{% endblock %}

{% block extra_css %}
<style>
    .detail-layout {
        display: grid;
        grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.3fr);
        gap: 26px;
        align-items: flex-start;
    }

    @media (max-width: 900px) {
        .detail-layout {
            grid-template-columns: 1fr;
        }
    }

    /* Gallery */
    .gallery-wrapper {
        display: grid;
        grid-template-columns: 90px minmax(0, 1fr);
        gap: 12px;
        align-items: flex-start;
    }

    @media (max-width: 700px) {
        .gallery-wrapper {
            grid-template-columns: 1fr;
        }
    }

    .thumbs {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .thumbs img {
        width: 100%;
        height: 80px;
        border-radius: 12px;
        object-fit: cover;
        border: 2px solid var(--c-border);
        background: #EEDCC4;
    }

    .main-photo {
        background: #000;
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    }

    .main-photo img {
        width: 100%;
        max-height: 400px;
        object-fit: cover;
        display: block;
    }

    /* Info Card */
    .info-card {
        background: var(--c-panel);
        border-radius: 18px;
        padding: 22px 22px 26px;
        border: 1px solid var(--c-border);
        box-shadow: 0 4px 14px rgba(0,0,0,0.09);
    }

    .detail-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
        margin-bottom: 16px;
    }

    .detail-name {
        font-size: 28px;
        font-family: Inter;
        font-weight: 700;
        color: var(--c-text);
    }

    .detail-sub {
        font-size: 14px;
        color: var(--c-muted);
        margin-top: 3px;
    }

    /* Status pill */
    .status-pill {
        padding: 6px 14px;
        border-radius: 999px;
        font-size: 11px;
        font-family: Inter;
        text-transform: uppercase;
        letter-spacing: 0.7px;
        font-weight: 700;
    }
    .status-available { background:#d1e7dd;color:#0f5132; }
    .status-reserved { background:#fff3cd;color:#664d03; }
    .status-adopted  { background:#f8d7da;color:#842029; }
    .status-pending  { background:#e2e3e5;color:#41464b; }

    /* Profile Sections */
    .detail-sections {
        display: grid;
        grid-template-columns: 1.1fr 1.3fr;
        gap: 22px;
    }

    @media (max-width: 700px) {
        .detail-sections {
            grid-template-columns: 1fr;
        }
    }

    .section-block {
        margin-top: 8px;
    }

    .section-block h3 {
        margin: 0 0 8px;
        font-size: 16px;
        color: var(--c-text);
        text-transform: uppercase;
        letter-spacing: 0.6px;
        font-family: Inter;
    }

    .profile-list p {
        margin: 4px 0;
        font-size: 14px;
        color: var(--c-text);
    }

    /* Health tags */
    .health-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
    }

    .health-tag {
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 12px;
        background: #F4E8D6;
        font-family: Inter;
        color: var(--c-text);
    }
    .health-tag.good { background:#d1e7dd;color:#0f5132; }
    .health-tag.warn { background:#fff3cd;color:#664d03; }

    /* About text */
    .about-text {
        font-size: 14px;
        line-height: 1.55;
        color: #4b4537;
        margin-top: 6px;
    }

    /* Footer Actions */
    .detail-footer {
        margin-top: 20px;
        display: flex;
        flex-wrap: wrap;
        gap: 14px;
        align-items: center;
    }

    .muted-note {
        color: var(--c-muted);
        font-size: 12px;
    }
</style>
{% endblock %}

{% block content %}
<div class="detail-layout">

    <!-- LEFT: Gallery -->
    <div class="gallery-wrapper">

        <div class="thumbs">
            <img src="{{ animal.photo_url|default:'https://via.placeholder.com/400x300?text=Animal' }}">
            <img src="{{ animal.photo_url|default:'https://via.placeholder.com/400x300?text=Animal' }}">
            <img src="{{ animal.photo_url|default:'https://via.placeholder.com/400x300?text=Animal' }}">
        </div>

        <div class="main-photo">
            <img src="{{ animal.photo_url|default:'https://via.placeholder.com/800x400?text=Animal' }}" alt="{{ animal.name }}">
        </div>
    </div>

    <!-- RIGHT: Info Card -->
    <div class="info-card">

        <!-- HEADER -->
        <div class="detail-header">

            <div>
                <div class="detail-name">{{ animal.name }}</div>
                <div class="detail-sub">
                    {{ animal.type }}
                    {% if animal.breed %} ¬∑ {{ animal.breed }}{% endif %}
                </div>
            </div>

            <div>
                <span class="status-pill
                    {% if animal.status == 'available' %}status-available{% endif %}
                    {% if animal.status == 'reserved' %}status-reserved{% endif %}
                    {% if animal.status == 'adopted' %}status-adopted{% endif %}
                    {% if animal.status == 'pending' %}status-pending{% endif %}
                ">
                    {{ animal.get_status_display }}
                </span>
            </div>

        </div>

        <!-- PROFILE SECTIONS -->
        <div class="detail-sections">

            <!-- PROFILE INFO -->
            <div class="section-block">
                <h3>Profile</h3>
                <div class="profile-list">
                    <p><strong>Age:</strong> {{ animal.age|default:"Unknown" }}</p>
                    <p><strong>Size:</strong> {{ animal.size|default:"Unknown" }}</p>
                    <p><strong>Gender:</strong> {{ animal.gender|default:"Unknown" }}</p>
                    <p><strong>Location:</strong> {{ animal.location|default:"Unknown" }}</p>
                </div>
            </div>

            <!-- HEALTH INFO -->
            <div class="section-block">
                <h3>Health & Traits</h3>
                <div class="health-tags">
                    <span class="health-tag {% if animal.vaccinated %}good{% endif %}">
                        ü©∫ Vaccinated: {{ animal.vaccinated|yesno:"Yes,No" }}
                    </span>

                    <span class="health-tag {% if animal.sterilized %}good{% endif %}">
                        ‚úÇ Sterilized: {{ animal.sterilized|yesno:"Yes,No" }}
                    </span>

                    <span class="health-tag {% if animal.dewormed %}good{% endif %}">
                        üêõ Dewormed: {{ animal.dewormed|yesno:"Yes,No" }}
                    </span>

                    {% if animal.medical_conditions %}
                    <span class="health-tag warn">
                        ‚öï Conditions: {{ animal.medical_conditions }}
                    </span>
                    {% endif %}
                </div>
            </div>

        </div>

        <!-- ABOUT -->
        <div class="section-block" style="margin-top:16px;">
            <h3>About {{ animal.name }}</h3>
            <p class="about-text">
                {{ animal.description|default:"No description has been provided yet." }}
            </p>
        </div>

        <!-- ADOPTION BUTTON -->
        <div class="detail-footer">

            {% if animal.status == "available" %}
            <form method="post" action="{% url 'api_animal_adopt' animal.id %}">
                {% csrf_token %}
                <button class="btn" type="submit">ü§ç Adopt {{ animal.name }}</button>
            </form>
            <span class="muted-note">
                The shelter will contact you to complete the adoption.
            </span>

            {% elif animal.status == "pending" %}
            <button class="btn btn-secondary" disabled>Waiting for admin approval</button>

            {% elif animal.status == "reserved" %}
            <button class="btn btn-secondary" disabled>Already reserved</button>

            {% elif animal.status == "adopted" %}
            <button class="btn btn-secondary" disabled>Already adopted</button>
            {% endif %}

        </div>

    </div>
</div>
{% endblock %}
