{% extends "shared/base.html" %}
{% load static %}

{% block title %}Catalogue des Animaux{% endblock %}

{% block content %}
<style>

/* ====== PAGE LAYOUT ====== */
.catalog-container {
    display: grid;
    grid-template-columns: 240px 1fr;
    gap: 24px;
}

/* ====== FLOATING GLASS EFFECT ====== */
.glass {
    background: rgba(255, 255, 255, 0.35);
    backdrop-filter: blur(14px);
    border-radius: 14px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.10);
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* ====== FILTER PANEL ====== */
.filter-panel {
    padding: 20px;
    background: rgba(255, 255, 255, 0.30);
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.45);
    backdrop-filter: blur(18px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.08);
    position: sticky;
    top: 90px;
}

.filter-panel h3 {
    margin-bottom: 12px;
    color: #414833;
}

.filter-panel label {
    display: block;
    margin-top: 10px;
    font-size: 0.9rem;
    color: #656D4A;
}

.filter-panel input,
.filter-panel select {
    width: 100%;
    padding: 8px;
    margin-top: 4px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.55);
    border: 1px solid rgba(0,0,0,0.15);
    backdrop-filter: blur(6px);
}

/* Search Btn */
.filter-panel button {
    width: 100%;
    margin-top: 18px;
    padding: 10px;
    border-radius: 10px;
    border: none;
    background: rgba(127, 85, 57, 0.85);
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: 0.2s;
    backdrop-filter: blur(5px);
}

.filter-panel button:hover {
    background: rgba(166, 138, 100, 0.9);
}

/* ====== CARDS ====== */
.animals-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 22px;
}

.card {
    background: rgba(255, 255, 255, 0.45);
    border: 1px solid rgba(255, 255, 255, 0.35);
    border-radius: 18px;
    overflow: hidden;
    backdrop-filter: blur(16px);
    transition: 0.25s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,0.10);
}

.card:hover {
    transform: scale(1.03);
    box-shadow: 0 15px 35px rgba(0,0,0,0.16);
}

.animal-photo {
    width: 100%;
    height: 190px;
    object-fit: cover;
}

/* Meet Button */
.view-btn {
    display: block;
    margin-top: 10px;
    padding: 8px;
    border-radius: 12px;
    border: 1px solid rgba(127, 85, 57, 0.6);
    color: #7F5539;
    background: rgba(255, 255, 255, 0.35);
    backdrop-filter: blur(6px);
    text-align: center;
    text-decoration: none;
    transition: 0.2s;
    font-size: 0.9rem;
}

.view-btn:hover {
    background: rgba(127, 85, 57, 0.15);
}

/* ====== FLOATING SIDE PANEL ====== */
.detail-panel {
    position: fixed;
    top: 0;
    right: -450px; /* hidden */
    width: 400px;
    height: 100vh;
    background: rgba(255, 255, 255, 0.45);
    border-left: 1px solid rgba(255,255,255,0.45);
    backdrop-filter: blur(22px);
    box-shadow: -10px 0 30px rgba(0,0,0,0.12);
    overflow-y: auto;
    padding: 20px 24px;
    transition: right 0.35s ease;
    z-index: 3000;
    border-radius: 25px 0 0 25px;
}

/* Open panel on :target */
.detail-panel:target {
    right: 0;
}

.detail-panel img {
    width: 100%;
    border-radius: 18px;
    margin-bottom: 16px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.10);
}

/* Close button */
.close-panel {
    position: absolute;
    top: 14px;
    left: 18px;
    font-size: 28px;
    text-decoration: none;
    color: #7F5539;
    font-weight: bold;
    background: rgba(255,255,255,0.45);
    padding: 4px 10px;
    border-radius: 50%;
    backdrop-filter: blur(6px);
}

/* Adopt button */
.adopt-btn {
    display: block;
    padding: 14px;
    background: rgba(127, 85, 57, 0.9);
    color: white;
    text-align: center;
    border-radius: 14px;
    text-decoration: none;
    margin-top: 20px;
    font-size: 1rem;
    transition: 0.2s;
    box-shadow: 0 8px 22px rgba(0,0,0,0.1);
}

.adopt-btn:hover {
    background: rgba(166, 138, 100, 1);
}

.disabled-btn {
    padding: 14px;
    background: rgba(100,100,100,0.4);
    color: white;
    text-align: center;
    border-radius: 14px;
    margin-top: 20px;
    font-size: 1rem;
    backdrop-filter: blur(6px);
}

</style>


<!-- ======================= PAGE ======================= -->

<div class="catalog-container">

    <!-- FILTERS -->
    <aside class="filter-panel">
        <h3>üîé Filter Animals</h3>

        <form method="GET">
            <label>Keyword</label>
            <input type="text" name="q" placeholder="Search...">

            <label>Type</label>
            <select name="type">
                <option value="">Any</option>
                <option>Dog</option>
                <option>Cat</option>
                <option>Bird</option>
                <option>Rabbit</option>
                <option>Other</option>
            </select>

            <label>Age</label>
            <input type="number" name="age">

            <label>Location</label>
            <input type="text" name="location">

            <label>Vaccinated</label>
            <select name="vaccinated">
                <option value="">Any</option>
                <option>true">Yes</option>
                <option>false">No</option>
            </select>

            <button>Search</button>
        </form>

        <hr style="margin:20px 0; opacity:0.3;">

        <a href="{% url 'client_propose_animal' %}" 
           class="adopt-btn" 
           style="text-align:center; display:block;">
             Propose an Animal
        </a>
    </aside>

    <!-- ANIMAL GRID -->
    <section>
        <h1 class="page-title">Find a Friend ‚ù§Ô∏è</h1>

        <div class="animals-grid">
            {% for a in animals %}
            <div class="card">
                <img src="{{ a.photo_url }}" class="animal-photo">

                <div class="card-content">
                    <h3>{{ a.name }}</h3>
                    <p>{{ a.type }} ‚Ä¢ {{ a.age }} yrs</p>

                    <a href="#animal-{{ a.id }}" class="view-btn">
                        ü§ç Meet {{ a.name }}
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
</div>

<!-- ============ DETAIL PANELS FOR EACH ANIMAL ============ -->
{% for a in animals %}
<div id="animal-{{ a.id }}" class="detail-panel">

    <a href="#" class="close-panel">√ó</a>

    <img src="{{ a.photo_url }}">

    <h2>{{ a.name }}</h2>
    <p><strong>Type:</strong> {{ a.type }}</p>
    <p><strong>Age:</strong> {{ a.age }} years</p>
    <p><strong>Location:</strong> {{ a.location }}</p>

    <p style="margin-top:15px;">{{ a.description }}</p>

    {% if a.status == "available" %}
<a href="http://127.0.0.1:8003/adoption/create/?animal_id={{ a.id }}&user_id={{ user_id }}"
   class="adopt-btn">
   ü§ç Adopt {{ a.name }}
</a>
{% else %}
<div class="disabled-btn">{{ a.status|title }}</div>
{% endif %}
</div>
{% endfor %}

{% endblock %}
