{% extends "shared/base.html" %}
{% load static %}

{% block title %}Catalogue des Animaux{% endblock %}

{% block content %}
<style>
/* ================= ADMIN-LIKE THEME ================= */
:root {
    --brown: #7F5539;
    --light-brown: #A68A64;
    --cream: #EDE0D4;
    --olive: #656D4A;
    --dark-olive: #414833;
    --muted-olive: rgba(101, 109, 74, 0.8);
    --shadow-soft: 0 18px 45px rgba(33, 37, 26, 0.18);
    --transition: all 0.25s ease;
}

/* ====== PAGE LAYOUT ====== */
.catalog-container {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 26px;
    align-items: start;   /* üî• prevents vertical stretch */
}

/* ====== FILTER PANEL (ADMIN STYLE) ====== */
.filter-panel {
    padding: 22px;
    width: 280px;

    background: radial-gradient(circle at top left,
        rgba(253, 250, 245, 0.96),
        rgba(237, 224, 212, 0.92));

    border-radius: 24px;
    border: 1px solid rgba(127, 85, 57, 0.18);
    backdrop-filter: blur(16px);
    box-shadow: var(--shadow-soft);

    position: sticky;
    top: 90px;

    height: fit-content;
    align-self: flex-start;
}


/* ===== TITLE ===== */
.filter-panel h3 {
    margin-bottom: 14px;
    font-size: 1rem;
    color: var(--dark-olive);
}

/* ===== LABELS ===== */
.filter-panel label {
    display: block;
    margin-top: 12px;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--muted-olive);
}

/* ===== INPUTS ===== */
.filter-panel input,
.filter-panel select {
    width: 100%;
    padding: 10px 12px;            /* smaller but comfy */
    margin-top: 6px;
    border-radius: 12px;
    background: rgba(255,255,255,0.9);
    border: 1px solid rgba(65,72,51,0.25);
    font-size: 0.85rem;
    box-sizing: border-box;
}

/* ===== BUTTON ===== */
.filter-panel {
    padding: 20px;
    width: 280px;

    background: radial-gradient(circle at top left,
        rgba(253, 250, 245, 0.96),
        rgba(237, 224, 212, 0.94));

    border-radius: 22px;
    border: 1px solid rgba(127, 85, 57, 0.18);
    backdrop-filter: blur(18px);
    box-shadow: var(--shadow-soft);

    position: sticky;
    top: 90px;

    height: fit-content;   /* üî• KEY LINE */
    align-self: flex-start; /* üî• prevents stretching */
}


/* ====== CARDS GRID ====== */
.animals-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 22px;
}

/* ====== ANIMAL CARD (ADMIN CARD STYLE) ====== */
.card {
    background: linear-gradient(145deg,
        rgba(255, 255, 255, 0.96),
        rgba(237, 224, 212, 0.94));
    border-radius: 18px;
    border: 1px solid rgba(127, 85, 57, 0.18);
    box-shadow: 0 12px 30px rgba(90, 61, 42, 0.10);
    transition: 0.25s ease;
}


.card:hover {
    transform: translateY(-4px);
    box-shadow: 0 18px 40px rgba(87,62,45,0.16);
}

.animal-photo {
    width: 100%;
    height: 190px;
    object-fit: cover;
}

/* ====== BUTTON ====== */
.view-btn {
    margin-top: 12px;
    padding: 8px;
    border-radius: 999px;
    border: 1px solid rgba(127,85,57,0.45);
    color: var(--brown);
    background: rgba(255,255,255,0.8);
    text-align: center;
    text-decoration: none;
    font-size: 0.85rem;
    transition: var(--transition);
}

.view-btn:hover {
    background: rgba(127,85,57,0.12);
}

/* ====== SIDE DETAIL PANEL (ADMIN SLIDE STYLE) ====== */
.detail-panel {
    overflow-y: auto;
    position: fixed;
    top: 0;
    right: -460px;
    width: 420px;
    height: 100vh;
    padding: 26px 28px;
    background: radial-gradient(circle at top left,
        rgba(253,250,245,0.96),
        rgba(237,224,212,0.94));
    border-left: 1px solid rgba(127,85,57,0.25);
    backdrop-filter: blur(22px);
    box-shadow: -12px 0 40px rgba(0,0,0,0.18);
    transition: var(--transition);
    border-radius: 32px 0 0 32px;
    z-index: 3000;
    opacity: 0;
    transform: translateX(40px) scale(0.96);
}

/* OPEN PANEL */
.detail-panel:target {
    right: 0;
    opacity: 1;
    transform: translateX(0) scale(1);
}

.detail-panel img {
    width: 100%;
    border-radius: 18px;
    margin-bottom: 16px;
}

/* Close */
.close-panel {
    position: absolute;
    top: 16px;
    left: 18px;
    font-size: 30px;
    text-decoration: none;
    color: var(--brown);
    font-weight: bold;
}

/* ====== ADOPT BUTTON ====== */
.adopt-btn {
    display: block;
    padding: 12px;
    margin-top: 22px;
    background: linear-gradient(135deg, var(--brown), #9C6644);
    color: white;
    text-align: center;
    border-radius: 999px;
    text-decoration: none;
    font-weight: 600;
    box-shadow: 0 8px 22px rgba(0,0,0,0.15);
    transition: var(--transition);
}

.adopt-btn:hover {
    transform: translateY(-1px);
}

.disabled-btn {
    margin-top: 22px;
    padding: 12px;
    background: rgba(120,120,120,0.35);
    color: white;
    border-radius: 999px;
    text-align: center;
}
/* ===== DETAIL GRID ===== */
.detail-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px 16px;
    margin: 14px 0;
}

/* ===== STATUS BADGE ===== */
.status-badge {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 14px;
}

.status-available {
    background: rgba(101, 109, 74, 0.18);
    color: var(--olive);
}

.status-reserved {
    background: rgba(130, 119, 190, 0.18);
    color: #5b4a9c;
}

.status-adopted {
    background: rgba(120,120,120,0.25);
    color: #555;
}

.status-pending {
    background: rgba(201, 155, 52, 0.22);
    color: #8a6b1d;
}

/* ===== HEALTH TAGS ===== */
.health-tags {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin: 10px 0 16px;
}

.tag {
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 600;
    background: rgba(255,255,255,0.7);
}

.tag.ok {
    background: rgba(101, 109, 74, 0.18);
    color: var(--olive);
}

.tag.no {
    background: rgba(180, 70, 70, 0.18);
    color: #8b2f2f;
}

/* ===== MEDICAL ===== */
.medical-box {
    background: rgba(255,255,255,0.7);
    border-left: 4px solid #c95b5b;
    padding: 10px 14px;
    border-radius: 10px;
}

/* ===== META ===== */
.meta {
    font-size: 0.8rem;
    opacity: 0.75;
    margin-top: 14px;
}

</style>



<!-- ======================= PAGE ======================= -->

<div class="catalog-container">

    <!-- FILTERS -->
    <aside class="filter-panel">
        <h3>üîé Filter Animals</h3>

        <form method="GET">
            <label>Keyword</label>
            <input type="text" name="q" placeholder="Search...">

            <label>Type</label>
            <select name="type">
                <option value="">Any</option>
                <option>Dog</option>
                <option>Cat</option>
                <option>Bird</option>
                <option>Rabbit</option>
                <option>Other</option>
            </select>

            <label>Age</label>
            <input type="number" name="age">

            <label>Location</label>
            <input type="text" name="location">

            <label>Vaccinated</label>
            <select name="vaccinated">
                <option value="">Any</option>
                <option>true">Yes</option>
                <option>false">No</option>
            </select>

            <button class="adopt-btn">Search</button>
        </form>

        <hr style="margin:20px 0; opacity:0.3;">

        <a href="{% url 'client_propose_animal' %}" 
           class="adopt-btn" 
           style="text-align:center; display:block;">
             Propose an Animal
        </a>
    </aside>

    <!-- ANIMAL GRID -->
    <section>
        <h1 class="page-title">Find a Friend ‚ù§Ô∏è</h1>

        <div class="animals-grid">
            {% for a in animals %}
            <div class="card">
                <img src="{{ a.photo_url }}" class="animal-photo">

                <div class="card-content">
                    <h3>{{ a.name }}</h3>
                    <p>{{ a.type }} ‚Ä¢ {{ a.age }} yrs</p>

                    <a href="#animal-{{ a.id }}" class="view-btn">
                        ü§ç Meet {{ a.name }}
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
</div>

<!-- ============ DETAIL PANELS FOR EACH ANIMAL ============ -->
{% for a in animals %}
<div id="animal-{{ a.id }}" class="detail-panel">

    <a href="#" class="close-panel">√ó</a>

    <img src="{{ a.photo_url|default:'/static/img/animal-placeholder.jpg' }}">

    <h2>{{ a.name }}</h2>

    <!-- STATUS BADGE -->
    <span class="status-badge status-{{ a.status }}">
        {{ a.status|title }}
    </span>
{% if a.status == "available" %}
        <a href="http://127.0.0.1:8003/adoption/create/?animal_id={{ a.id }}"
           class="adopt-btn">
            ü§ç Adopt {{ a.name }}
        </a>
    {% else %}
        <div class="disabled-btn">
            {{ a.status|title }}
        </div>
    {% endif %}
    <div class="detail-grid">
        <p><strong>Type:</strong> {{ a.type }}</p>
        <p><strong>Breed:</strong> {{ a.breed|default:"Unknown" }}</p>
        <p><strong>Age:</strong> {{ a.age }}</p>
        <p><strong>Gender:</strong> {{ a.gender|default:"Not specified" }}</p>
        <p><strong>Size:</strong> {{ a.size|default:"Medium" }}</p>
        <p><strong>Location:</strong> {{ a.location }}</p>
    </div>

    <!-- HEALTH -->
    <h4>ü©∫ Health</h4>
    <div class="health-tags">
        <span class="tag {% if a.vaccinated %}ok{% else %}no{% endif %}">
            üíâ Vaccinated
        </span>
        <span class="tag {% if a.sterilized %}ok{% else %}no{% endif %}">
            ‚úÇÔ∏è Sterilized
        </span>
        <span class="tag {% if a.dewormed %}ok{% else %}no{% endif %}">
            ü™± Dewormed
        </span>
    </div>

    {% if a.medical_conditions %}
        <h4>‚ö†Ô∏è Medical Conditions</h4>
        <p class="medical-box">{{ a.medical_conditions }}</p>
    {% endif %}

    <h4>üìñ About</h4>
    <p>{{ a.description|default:"No description provided." }}</p>

    <p class="meta">
        Submitted by: 
        <strong>
            {% if a.submitted_by_user %}Community member{% else %}Shelter{% endif %}
        </strong><br>
        Added on {{ a.created_at|date:"M d, Y" }}
    </p>

    
</div>

{% endfor %}

{% endblock %}
